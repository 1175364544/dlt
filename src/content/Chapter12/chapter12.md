# Chapter12  神经情感分析
&emsp;&emsp;在本章中，我们将讨论自然语言处理中的热点和流行应用之一，即情感分析。如今，大多数人都通过社交媒体平台来表达自己对某件事的看法，而利用这一庞大的文本来追踪顾客对某件事的满意程度，对于公司甚至政府来说都是至关重要的。<br>
&emsp;&emsp;在本章中，我们将使用循环神经网络来建立一个情感分析的解决方案。本章将讨论以下主题：<br>
&emsp;&emsp;●一般情感分析体系结构<br>
&emsp;&emsp;●情感分析——模型实现<br>
## 一、一般情感分析体系结构
&emsp;&emsp;在本节中，我们将重点介绍可用于情感分析的一般深度学习体系结构。下图显示了构建情感分析模型所需的处理步骤。<br>
&emsp;&emsp;因此，首先，我们将讨论自然人类语言：<br>
![](https://github.com/yanjiusheng2018/dlt/blob/master/src/content/Chapter12/chapter12_image/picture1.png)<br>
&emsp;&emsp;       图1：情感分析解决方案的一般传递途径，甚至是基于序列的自然语言解决方案<br>
&emsp;&emsp;我们将使用电影评论来构建这个情感分析应用程序。此应用程序的目标是根据输入的原始文本生成正面和负面的评论。例如，如果原始文本是这样的，“this movie is good”，那么我们需要模型来产生一个积极的情感。如果原始文本是“this is not a good movie”，那么我们就需要模型来产生一个消极的情感。情感分析应用程序将带领我们完成许多处理步骤，这些步骤是在神经网络(如嵌入)中使用自然人类语言所需要的。在这类应用中有几个困难：<br>
&emsp;&emsp;其中之一是序列可能有不同的长度。<br>
&emsp;&emsp;另一个问题是，如果我们只看单个单词(例如，good)，就会显示出一种积极的情感。然而，它的前面是“not”一词，那么它就是一种负面情感。这会使得我们的分析变得更加复杂，稍后我们会看到一个例子。<br>
&emsp;&emsp;正如我们在上一章中所了解的，神经网络不能工作在原始文本上，所以我们首先需要将它转换为所谓的数字。这些基本上都是整数值，我们需要遍历整个数据集，计算每个单词被使用的次数；然后，我们制作一个词汇表，每个单词都在这个词汇表中得到一个索引。如图1，单词this就转化为整数11，单词is转化为6，依此类推。
&emsp;&emsp;现在，我们已经将原始文本转换为一个名为token的整数列表。但神经网络仍然不能对这些数据进行操作，因为如果我们有10000个单词的词汇表，这些数字可以取0到9999之间的值，它们可能根本不相关。因此，与数字999相比，数字998可能有一个完全不同的语义。因此，我们将使用我们在上一章中学习到的表示学习或嵌入的思想。这个嵌入层将数字列表转换为实值向量，因此数字11转换为向量[0.67，0.36，…，0.39]，如图1所示。同样的情况也适用于下一个数字6。<br>
&emsp;&emsp;快速回顾我们在前一章中研究的内容：图1中所示的嵌入层会学习数字列表与它们对应的实值向量之间的映射。此外，嵌入层还会学习单词的语义，以便在这个嵌入空间中具有相似意义的单词之间有某种程度的接近。<br>
&emsp;&emsp;从输入的原始文本中，我们得到一个二维矩阵，即张量，它现在可以输入到循环神经网络(RNN)。它可以处理任意长度的序列，然后使该网络的输出具有Sigmoid激活函数的完全连接或dense层。因此，输出介于0到1之间，其中0值被认为是消极情感，1值被认为是积极情感。但是，如果Sigmoid函数的值既不是0也不是1呢？我们就需要在中间引入一个截断值或一个阈值，这样如果这个值低于0.5，那么相应的输入就被认为是一种消极情感，而高于这个阈值的值就会被认为是一种积极情感。<br>
